\begin{code}[hide]
module Paper.Section4-SystemF where

open import Data.List using (List; []; _âˆ·_)
\end{code}

\newpage
\section{System F}

The usual formalization of extrinsic STLC:
\begin{code}[hide]
module STLCFin where
  open import Data.Nat
  open import Data.Fin
  variable n : â„•
\end{code}
\begin{code}
  data Expr : â„• â†’ Set where
    `_   : Fin n â†’ Expr n
    Î»x_  : Expr (suc n) â†’ Expr n
    _Â·_  : Expr n â†’ Expr n â†’ Expr n
\end{code}

An isomorphic formalization of extrinsic STLC:
\begin{code}[hide]
module STLCUnit where
\end{code}
\begin{code}
  data Type : Set where
    â˜… : Type -- Dynamic
\end{code}
\begin{code}[hide]
  private variable Î“ : List Type
  private variable t tâ‚ tâ‚‚ : Type

  infix  4  _âˆ‹_  _âŠ¢_

  data _âˆ‹_ : List Type â†’ Type â†’ Set where
    zero  : (â˜… âˆ· Î“ âˆ‹ â˜…)
    suc   : (Î“ âˆ‹ â˜…) â†’ (â˜… âˆ· Î“ âˆ‹ â˜…)
\end{code}
\begin{code}
  data _âŠ¢_ : List Type â†’ Type â†’ Set where
    `_   : (Î“ âˆ‹ â˜…) â†’ (Î“ âŠ¢ â˜…)
    Î»x_  : (â˜… âˆ· Î“ âŠ¢ â˜…) â†’ (Î“ âŠ¢ â˜…)
    _Â·_  : (Î“ âŠ¢ â˜…) â†’ (Î“ âŠ¢ â˜…) â†’ (Î“ âŠ¢ â˜…)
\end{code}

System F:

\begin{code}
-- Variable Modes
data Modeáµ¥ : Set where
  ğ•– : Modeáµ¥  -- Expression-level variables
  ğ•¥ : Modeáµ¥  -- Type-level variables

-- Term Modes
data Modeâ‚œ : Set where
  ğ•– : Modeâ‚œ  -- Expressions
  ğ•¥ : Modeâ‚œ  -- Types
  ğ•œ : Modeâ‚œ  -- Kinds

variable Âµ : List Modeáµ¥
\end{code}
\begin{code}[hide]
variable m m' : Modeáµ¥
infix  4  _âˆ‹_  _âŠ¢_
data _âˆ‹_ : List Modeáµ¥ â†’ Modeáµ¥ â†’ Set where
  zero  : (m âˆ· Âµ âˆ‹ m)
  suc   : (Âµ âˆ‹ m) â†’ (m' âˆ· Âµ âˆ‹ m)
\end{code}
\begin{code}
data _âŠ¢_ : List Modeáµ¥ â†’ Modeâ‚œ â†’ Set where
  `Ë£_   : (Âµ âˆ‹ ğ•–) â†’ (Âµ âŠ¢ ğ•–)
  `áµ…_   : (Âµ âˆ‹ ğ•¥) â†’ (Âµ âŠ¢ ğ•¥)
  Î»x_   : (ğ•– âˆ· Âµ âŠ¢ ğ•–) â†’ (Âµ âŠ¢ ğ•–)
  Î›Î±_   : (ğ•¥ âˆ· Âµ âŠ¢ ğ•–) â†’ (Âµ âŠ¢ ğ•–)
  âˆ€Î±_   : (ğ•¥ âˆ· Âµ âŠ¢ ğ•¥) â†’ (Âµ âŠ¢ ğ•¥)
  _Â·_   : (Âµ âŠ¢ ğ•–) â†’ (Âµ âŠ¢ ğ•–) â†’ (Âµ âŠ¢ ğ•–)
  _âˆ™_   : (Âµ âŠ¢ ğ•–) â†’ (Âµ âŠ¢ ğ•¥) â†’ (Âµ âŠ¢ ğ•–)
  _â‡’_   : (Âµ âŠ¢ ğ•¥) â†’ (Âµ âŠ¢ ğ•¥) â†’ (Âµ âŠ¢ ğ•¥)
  â˜…     : (Âµ âŠ¢ ğ•œ)
\end{code}
