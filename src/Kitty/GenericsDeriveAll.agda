module Kitty.GenericsDeriveExamples where

open import Kitty.Prelude
open import Kitty.Modes
open import Kitty.Generics hiding (âŸ¦_âŸ§)
open import Kitty.GenericsDerive

open import Data.List using (List; []; _âˆ·_)

open import Kitty.Iso
-- open import Kitty.Kit using (Kit; KitTraversal)
-- open import Kitty.Compose using (ComposeKit; KitAssoc)
-- open KitAssoc using (KitAssocLemmas)

module Modules {ğ•„ : Modes} {_âŠ¢_ : Scoped ğ•„} {d : Desc ğ•„} (iso : âˆ€ {Âµ} {e} â†’ (Âµ âŠ¢ e) â‰ƒ Tm ğ•„ d Âµ e) where
  private module I = FromIso ğ•„ iso
  open import Kitty.Kit I.terms using (Kit; KitTraversal) public
  open import Kitty.Compose I.terms I.kit-traversal using (ComposeKit; KitAssoc) public
  open KitAssoc I.kit-assoc using (WkDistKit; KitAssocLemmas) public

open import Relation.Binary.PropositionalEquality using (_â‰¡_)
module Derived {ğ•„ : Modes} {_âŠ¢_ : Scoped ğ•„} {d : Desc ğ•„} (iso : âˆ€ {Âµ} {e} â†’ (Âµ âŠ¢ e) â‰ƒ Tm ğ•„ d Âµ e) where
  module I = FromIso ğ•„ iso

  open Modes ğ•„
  open Terms I.terms using (`_)

  private variable
    m mâ‚ mâ‚‚ mâ‚ƒ m' mâ‚' mâ‚‚' mâ‚ƒ' : VarMode
    M Mâ‚ Mâ‚‚ Mâ‚ƒ M' Mâ‚' Mâ‚‚' Mâ‚ƒ' : TermMode
    Âµ Âµâ‚ Âµâ‚‚ Âµâ‚ƒ Âµ' Âµâ‚' Âµâ‚‚' Âµâ‚ƒ' : List VarMode

  open Modules iso public using (Kit; KitTraversal; ComposeKit; KitAssoc; WkDistKit; KitAssocLemmas)

  terms            : Terms ğ•„
  kit-traversal    : KitTraversal
  kit-assoc        : KitAssoc
  kit-assoc-lemmas : KitAssocLemmas
  kitáµ£             : Kit
  kitâ‚›             : Kit
  kitáµ£             = I.kitáµ£
  kitâ‚›             = I.kitâ‚›
  kitáµ£áµ£            : ComposeKit â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„
  kitáµ£â‚›            : ComposeKit â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„
  kitâ‚›áµ£            : ComposeKit â¦ƒ kitâ‚› â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„
  kitâ‚›â‚›            : ComposeKit â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„
  wk-kitáµ£          : WkDistKit â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„
  wk-kitâ‚›          : WkDistKit â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚›áµ£ â¦„ â¦ƒ kitáµ£â‚› â¦„

  open Kit {{...}} using (_âˆ‹/âŠ¢_; id/mâ†’M; `/id; VarMode/TermMode)

  -- _âˆ‹/âŠ¢_    : â¦ƒ K : Kit â¦„ â†’ List VarMode â†’ Kit.VarMode/TermMode K â†’ Set 
  _âˆ‹/âŠ¢[_]_ : List VarMode â†’ (K : Kit) â†’ Kit.VarMode/TermMode K â†’ Set
  Âµ âˆ‹/âŠ¢[ K ] m/M = Kit._âˆ‹/âŠ¢_ K Âµ m/M

  _â†’áµ£_    : List VarMode â†’ List VarMode â†’ Set _
  _â†’â‚›_    : List VarMode â†’ List VarMode â†’ Set _
  _â€“â†’_    : â¦ƒ K : Kit â¦„ â†’ List VarMode â†’ List VarMode â†’ Set _
  _â€“[_]â†’_ : List VarMode â†’ Kit â†’ List VarMode â†’ Set _
  Âµâ‚ â†’áµ£ Âµâ‚‚ = âˆ€ m â†’ Âµâ‚ âˆ‹ m â†’ Âµâ‚‚ âˆ‹ m
  Âµâ‚ â†’â‚› Âµâ‚‚ = âˆ€ m â†’ Âµâ‚ âˆ‹ m â†’ Âµâ‚‚ âŠ¢ mâ†’M m
  Âµâ‚ â€“â†’ Âµâ‚‚ = âˆ€ m â†’ Âµâ‚ âˆ‹ m â†’ Âµâ‚‚ âˆ‹/âŠ¢ id/mâ†’M m
  Âµâ‚ â€“[ K ]â†’ Âµâ‚‚ = Âµâ‚ â€“â†’ Âµâ‚‚ where instance _ = K

  wk  : âˆ€ â¦ƒ K : Kit â¦„ m/M â†’ Âµ âˆ‹/âŠ¢ m/M â†’ (Âµ â–· m') âˆ‹/âŠ¢ m/M
  wkáµ£ : âˆ€ m â†’ Âµ âˆ‹ m â†’ (Âµ â–· m') âˆ‹ m
  wkâ‚› : âˆ€ M â†’ Âµ âŠ¢ M â†’ (Âµ â–· m') âŠ¢ M

  wk*  : âˆ€ â¦ƒ K : Kit â¦„ m/M â†’ Âµ âˆ‹/âŠ¢ m/M â†’ (Âµ â–·â–· Âµ') âˆ‹/âŠ¢ m/M
  wkáµ£* : âˆ€ m â†’ Âµ âˆ‹ m â†’ (Âµ â–·â–· Âµ') âˆ‹ m
  wkâ‚›* : âˆ€ M â†’ Âµ âŠ¢ M â†’ (Âµ â–·â–· Âµ') âŠ¢ M

  id  : â¦ƒ K : Kit â¦„ â†’ Âµ â€“â†’ Âµ
  idáµ£ : Âµ â†’áµ£ Âµ
  idâ‚› : Âµ â†’â‚› Âµ

  _â†‘_  : â¦ƒ K : Kit â¦„ â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚‚ â†’ âˆ€ m â†’ (Âµâ‚ â–· m) â€“[ K ]â†’ (Âµâ‚‚ â–· m)
  _â†‘áµ£_ : Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ âˆ€ m â†’ (Âµâ‚ â–· m) â†’áµ£ (Âµâ‚‚ â–· m)
  _â†‘â‚›_ : Âµâ‚ â†’â‚› Âµâ‚‚ â†’ âˆ€ m â†’ (Âµâ‚ â–· m) â†’â‚› (Âµâ‚‚ â–· m)

  _â†‘*_  : â¦ƒ K : Kit â¦„ â†’ Âµâ‚ â€“â†’ Âµâ‚‚ â†’ âˆ€ Âµ' â†’ (Âµâ‚ â–·â–· Âµ') â€“â†’ (Âµâ‚‚ â–·â–· Âµ')
  _â†‘áµ£*_ : Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ âˆ€ Âµ' â†’ (Âµâ‚ â–·â–· Âµ') â†’áµ£ (Âµâ‚‚ â–·â–· Âµ')
  _â†‘â‚›*_ : Âµâ‚ â†’â‚› Âµâ‚‚ â†’ âˆ€ Âµ' â†’ (Âµâ‚ â–·â–· Âµ') â†’â‚› (Âµâ‚‚ â–·â–· Âµ')

  idâ†‘â‰¡id  : â¦ƒ K : Kit â¦„ â†’ âˆ€ m Âµ â†’ id â†‘ m â‰¡ id {Âµ = Âµ â–· m}
  idâ†‘â‰¡idáµ£ : âˆ€ m Âµ â†’ idáµ£ â†‘áµ£ m â‰¡ idáµ£ {Âµ = Âµ â–· m}
  idâ†‘â‰¡idâ‚› : âˆ€ m Âµ â†’ idâ‚› â†‘â‚› m â‰¡ idâ‚› {Âµ = Âµ â–· m}

  idâ†‘*â‰¡id : â¦ƒ K : Kit â¦„ â†’ âˆ€ Âµ' Âµ â†’ id â†‘* Âµ' â‰¡ id {Âµ = Âµ â–·â–· Âµ'}
  idâ†‘*â‰¡idáµ£ : âˆ€ Âµ' Âµ â†’ idáµ£ â†‘áµ£* Âµ' â‰¡ idáµ£ {Âµ = Âµ â–·â–· Âµ'}
  idâ†‘*â‰¡idâ‚› : âˆ€ Âµ' Âµ â†’ idâ‚› â†‘â‚›* Âµ' â‰¡ idâ‚› {Âµ = Âµ â–·â–· Âµ'}

  _,â‚–_ : â¦ƒ K : Kit â¦„ â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚‚ â†’ Âµâ‚‚ âˆ‹/âŠ¢ id/mâ†’M m â†’ (Âµâ‚ â–· m) â€“[ K ]â†’ Âµâ‚‚
  _,áµ£_ : Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ Âµâ‚‚ âˆ‹     m â†’ (Âµâ‚ â–· m) â†’áµ£ Âµâ‚‚
  _,â‚›_ : Âµâ‚ â†’â‚› Âµâ‚‚ â†’ Âµâ‚‚ âŠ¢ mâ†’M m â†’ (Âµâ‚ â–· m) â†’â‚› Âµâ‚‚

  â¦…_â¦†  : â¦ƒ K : Kit â¦„ â†’ Âµ âˆ‹/âŠ¢ id/mâ†’M m â†’ (Âµ â–· m) â€“â†’ Âµ
  â¦…_â¦†áµ£ : Âµ âˆ‹     m â†’ (Âµ â–· m) â†’áµ£ Âµ
  â¦…_â¦†â‚› : Âµ âŠ¢ mâ†’M m â†’ (Âµ â–· m) â†’â‚› Âµ

  â¦…_â¦†â‚€  : â¦ƒ K : Kit â¦„ â†’ Âµ âˆ‹/âŠ¢ id/mâ†’M m â†’ ([] â–· m) â€“â†’ Âµ
  â¦…_â¦†â‚€áµ£ : Âµ âˆ‹     m â†’ ([] â–· m) â†’áµ£ Âµ
  â¦…_â¦†â‚€â‚› : Âµ âŠ¢ mâ†’M m â†’ ([] â–· m) â†’â‚› Âµ

  0â‚– : â¦ƒ K : Kit â¦„ â†’ [] â€“[ K ]â†’ Âµ
  0áµ£ : [] â†’áµ£ Âµ
  0â‚› : [] â†’â‚› Âµ

  wk'   : â¦ƒ K : Kit â¦„ â†’ Âµ â€“â†’ (Âµ â–· m)
  wkáµ£'  : Âµ â†’áµ£ (Âµ â–· m)
  wkâ‚›'  : Âµ â†’â‚› (Âµ â–· m)

  wk'*  : â¦ƒ K : Kit â¦„ â†’ Âµ â€“â†’ (Âµ â–·â–· Âµ')
  wkáµ£'* : Âµ â†’áµ£ (Âµ â–·â–· Âµ')
  wkâ‚›'* : Âµ â†’â‚› (Âµ â–·â–· Âµ')

  _â‹¯_     : â¦ƒ K : Kit â¦„ â†’ Âµâ‚ âŠ¢ M â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚‚ â†’ Âµâ‚‚ âŠ¢ M
  _â‹¯â‚›_    : Âµâ‚ âŠ¢ M â†’ Âµâ‚ â†’â‚› Âµâ‚‚ â†’ Âµâ‚‚ âŠ¢ M
  _â‹¯áµ£_    : Âµâ‚ âŠ¢ M â†’ Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ Âµâ‚‚ âŠ¢ M

  âŸ¦_âŸ§â‚– : â¦ƒ K : Kit â¦„ â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚‚ â†’ (Âµâ‚ âŠ¢ M â†’ Âµâ‚‚ âŠ¢ M)
  âŸ¦_âŸ§â‚› : Âµâ‚ â†’â‚› Âµâ‚‚ â†’ (Âµâ‚ âŠ¢ M â†’ Âµâ‚‚ âŠ¢ M)
  âŸ¦_âŸ§áµ£ : Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ (Âµâ‚ âŠ¢ M â†’ Âµâ‚‚ âŠ¢ M)

  âŸ¦ Ï• âŸ§â‚– e = e â‹¯ Ï•
  âŸ¦ Ï• âŸ§â‚› e = e â‹¯â‚› Ï•
  âŸ¦ Ï• âŸ§áµ£ e = e â‹¯áµ£ Ï•

  _âˆ˜_     : â¦ƒ Kâ‚ Kâ‚‚ K : Kit â¦„ â¦ƒ _ : ComposeKit â¦ƒ Kâ‚ â¦„ â¦ƒ Kâ‚‚ â¦„ â¦ƒ K â¦„ â¦„ â†’ Âµâ‚‚ â€“[ Kâ‚ ]â†’ Âµâ‚ƒ â†’ Âµâ‚ â€“[ Kâ‚‚ ]â†’ Âµâ‚‚ â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚ƒ
  _âˆ˜áµ£_    : â¦ƒ K : Kit â¦„ â†’ Âµâ‚‚ â€“[ K ]â†’ Âµâ‚ƒ â†’ Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ Âµâ‚ â€“[ K ]â†’ Âµâ‚ƒ
  _âˆ˜â‚›_    : â¦ƒ K : Kit â¦„ â†’ Âµâ‚‚ â€“[ K ]â†’ Âµâ‚ƒ â†’ Âµâ‚ â†’â‚› Âµâ‚‚ â†’ Âµâ‚ â†’â‚› Âµâ‚ƒ
  _áµ£âˆ˜áµ£_   : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ â†’ Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ Âµâ‚ â†’áµ£ Âµâ‚ƒ
  _â‚›âˆ˜áµ£_   : Âµâ‚‚ â†’â‚› Âµâ‚ƒ â†’ Âµâ‚ â†’áµ£ Âµâ‚‚ â†’ Âµâ‚ â†’â‚› Âµâ‚ƒ
  _áµ£âˆ˜â‚›_   : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ â†’ Âµâ‚ â†’â‚› Âµâ‚‚ â†’ Âµâ‚ â†’â‚› Âµâ‚ƒ
  _â‚›âˆ˜â‚›_   : Âµâ‚‚ â†’â‚› Âµâ‚ƒ â†’ Âµâ‚ â†’â‚› Âµâ‚‚ â†’ Âµâ‚ â†’â‚› Âµâ‚ƒ

  dist-â†‘-âˆ˜ : âˆ€ â¦ƒ Kâ‚ Kâ‚‚ K : Kit â¦„ â¦ƒ _ : ComposeKit â¦ƒ Kâ‚ â¦„ â¦ƒ Kâ‚‚ â¦„ â¦ƒ K â¦„ â¦„
               m (Ï•â‚ : Âµâ‚‚ â€“[ Kâ‚ ]â†’ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â€“[ Kâ‚‚ ]â†’ Âµâ‚‚)
             â†’ (Ï•â‚ âˆ˜ Ï•â‚‚) â†‘ m â‰¡ (Ï•â‚ â†‘ m) âˆ˜ (Ï•â‚‚ â†‘ m)
  dist-â†‘-áµ£âˆ˜áµ£ : âˆ€ m (Ï•â‚ : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’áµ£ Âµâ‚‚)
               â†’ (Ï•â‚ áµ£âˆ˜áµ£ Ï•â‚‚) â†‘áµ£ m â‰¡ (Ï•â‚ â†‘áµ£ m) áµ£âˆ˜áµ£ (Ï•â‚‚ â†‘áµ£ m)
  dist-â†‘-áµ£âˆ˜â‚› : âˆ€ m (Ï•â‚ : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’â‚› Âµâ‚‚)
               â†’ (Ï•â‚ áµ£âˆ˜â‚› Ï•â‚‚) â†‘â‚› m â‰¡ (Ï•â‚ â†‘áµ£ m) áµ£âˆ˜â‚› (Ï•â‚‚ â†‘â‚› m)
  dist-â†‘-â‚›âˆ˜áµ£ : âˆ€ m (Ï•â‚ : Âµâ‚‚ â†’â‚› Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’áµ£ Âµâ‚‚)
               â†’ (Ï•â‚ â‚›âˆ˜áµ£ Ï•â‚‚) â†‘â‚› m â‰¡ (Ï•â‚ â†‘â‚› m) â‚›âˆ˜áµ£ (Ï•â‚‚ â†‘áµ£ m)
  dist-â†‘-â‚›âˆ˜â‚› : âˆ€ m (Ï•â‚ : Âµâ‚‚ â†’â‚› Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’â‚› Âµâ‚‚)
               â†’ (Ï•â‚ â‚›âˆ˜â‚› Ï•â‚‚) â†‘â‚› m â‰¡ (Ï•â‚ â†‘â‚› m) â‚›âˆ˜â‚› (Ï•â‚‚ â†‘â‚› m)

  dist-â†‘*-âˆ˜ : âˆ€ â¦ƒ Kâ‚ Kâ‚‚ K : Kit â¦„ â¦ƒ _ : ComposeKit â¦ƒ Kâ‚ â¦„ â¦ƒ Kâ‚‚ â¦„ â¦ƒ K â¦„ â¦„
                Âµ (Ï•â‚ : Âµâ‚‚ â€“[ Kâ‚ ]â†’ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â€“[ Kâ‚‚ ]â†’ Âµâ‚‚)
              â†’ (Ï•â‚ âˆ˜ Ï•â‚‚) â†‘* Âµ â‰¡ (Ï•â‚ â†‘* Âµ) âˆ˜ (Ï•â‚‚ â†‘* Âµ)
  dist-â†‘*-áµ£âˆ˜áµ£ : âˆ€ Âµ (Ï•â‚ : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’áµ£ Âµâ‚‚)
               â†’ (Ï•â‚ áµ£âˆ˜áµ£ Ï•â‚‚) â†‘áµ£* Âµ â‰¡ (Ï•â‚ â†‘áµ£* Âµ) áµ£âˆ˜áµ£ (Ï•â‚‚ â†‘áµ£* Âµ)
  dist-â†‘*-áµ£âˆ˜â‚› : âˆ€ Âµ (Ï•â‚ : Âµâ‚‚ â†’áµ£ Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’â‚› Âµâ‚‚)
               â†’ (Ï•â‚ áµ£âˆ˜â‚› Ï•â‚‚) â†‘â‚›* Âµ â‰¡ (Ï•â‚ â†‘áµ£* Âµ) áµ£âˆ˜â‚› (Ï•â‚‚ â†‘â‚›* Âµ)
  dist-â†‘*-â‚›âˆ˜áµ£ : âˆ€ Âµ (Ï•â‚ : Âµâ‚‚ â†’â‚› Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’áµ£ Âµâ‚‚)
               â†’ (Ï•â‚ â‚›âˆ˜áµ£ Ï•â‚‚) â†‘â‚›* Âµ â‰¡ (Ï•â‚ â†‘â‚›* Âµ) â‚›âˆ˜áµ£ (Ï•â‚‚ â†‘áµ£* Âµ)
  dist-â†‘*-â‚›âˆ˜â‚› : âˆ€ Âµ (Ï•â‚ : Âµâ‚‚ â†’â‚› Âµâ‚ƒ) (Ï•â‚‚ : Âµâ‚ â†’â‚› Âµâ‚‚)
               â†’ (Ï•â‚ â‚›âˆ˜â‚› Ï•â‚‚) â†‘â‚›* Âµ â‰¡ (Ï•â‚ â†‘â‚›* Âµ) â‚›âˆ˜â‚› (Ï•â‚‚ â†‘â‚›* Âµ)

  â‹¯-assoc : âˆ€ â¦ƒ Kâ‚ Kâ‚‚ K : Kit â¦„ â¦ƒ _ : ComposeKit â¦ƒ Kâ‚ â¦„ â¦ƒ Kâ‚‚ â¦„ â¦ƒ K â¦„ â¦„
              (v : Âµâ‚ âŠ¢ M) (Ï•â‚ : Âµâ‚ â€“[ Kâ‚‚ ]â†’ Âµâ‚‚) (Ï•â‚‚ : Âµâ‚‚ â€“[ Kâ‚ ]â†’ Âµâ‚ƒ) â†’
    (v â‹¯ Ï•â‚) â‹¯ Ï•â‚‚ â‰¡ v â‹¯ (Ï•â‚‚ âˆ˜ Ï•â‚)

  _âˆ¥_     : â¦ƒ K : Kit â¦„ â†’ âˆ€ {Âµâ‚ Âµâ‚‚ Âµ} â†’ (Âµâ‚ â€“[ K ]â†’ Âµ) â†’ (Âµâ‚‚ â€“[ K ]â†’ Âµ) â†’ ((Âµâ‚ â–·â–· Âµâ‚‚) â€“[ K ]â†’ Âµ)
  _âˆ¥áµ£_    : âˆ€ {Âµâ‚ Âµâ‚‚ Âµ} â†’ (Âµâ‚ â†’áµ£ Âµ) â†’ (Âµâ‚‚ â†’áµ£ Âµ) â†’ ((Âµâ‚ â–·â–· Âµâ‚‚) â†’áµ£ Âµ)
  _âˆ¥â‚›_    : âˆ€ {Âµâ‚ Âµâ‚‚ Âµ} â†’ (Âµâ‚ â†’â‚› Âµ) â†’ (Âµâ‚‚ â†’â‚› Âµ) â†’ ((Âµâ‚ â–·â–· Âµâ‚‚) â†’â‚› Âµ)

  â‹¯-var   : â¦ƒ K : Kit â¦„ (x : Âµâ‚ âˆ‹ m) (Ï• : Âµâ‚ â€“[ K ]â†’ Âµâ‚‚) â†’
            (` x) â‹¯ Ï• â‰¡ `/id _ (Ï• _ x)

  comm-â†‘-wk :
    âˆ€ â¦ƒ ğ•‚ : Kit â¦„
      â¦ƒ ğ”¸â‚ : ComposeKit â¦ƒ ğ•‚ â¦„    â¦ƒ kitáµ£ â¦„ â¦ƒ ğ•‚ â¦„ â¦„
      â¦ƒ ğ”¸â‚‚ : ComposeKit â¦ƒ kitáµ£ â¦„ â¦ƒ ğ•‚ â¦„    â¦ƒ ğ•‚ â¦„ â¦„
      â¦ƒ W : WkDistKit â¦ƒ ğ•‚ â¦„ â¦ƒ ğ”¸â‚ â¦„ â¦ƒ ğ”¸â‚‚ â¦„ â¦„
      (Ï• : Âµâ‚ â€“[ ğ•‚ ]â†’ Âµâ‚‚)
    â†’ let instance _ = kitáµ£ in
      (Ï• â†‘ m) âˆ˜ wkáµ£ â‰¡ wkáµ£ âˆ˜ Ï•

  comm-â†‘áµ£-wk : âˆ€ (Ï• : Âµâ‚ â†’áµ£ Âµâ‚‚) â†’ (Ï• â†‘áµ£ m) áµ£âˆ˜áµ£ wkáµ£ â‰¡ wkáµ£ áµ£âˆ˜áµ£ Ï•
  comm-â†‘â‚›-wk : âˆ€ (Ï• : Âµâ‚ â†’â‚› Âµâ‚‚) â†’ (Ï• â†‘â‚› m) â‚›âˆ˜áµ£ wkáµ£ â‰¡ wkáµ£ áµ£âˆ˜â‚› Ï•

  wk-cancels-,â‚–-âˆ˜ :
    âˆ€ â¦ƒ ğ•‚ : Kit â¦„
      â¦ƒ ğ”¸â‚ : ComposeKit â¦ƒ ğ•‚ â¦„    â¦ƒ kitáµ£ â¦„ â¦ƒ ğ•‚ â¦„ â¦„
      â¦ƒ ğ”¸â‚‚ : ComposeKit â¦ƒ kitáµ£ â¦„ â¦ƒ ğ•‚ â¦„    â¦ƒ ğ•‚ â¦„ â¦„
      â¦ƒ W : WkDistKit â¦ƒ ğ•‚ â¦„ â¦ƒ ğ”¸â‚ â¦„ â¦ƒ ğ”¸â‚‚ â¦„ â¦„
      (Ï• : Âµâ‚ â€“[ ğ•‚ ]â†’ Âµâ‚‚) (v : Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚ ] id/mâ†’M m)
    â†’ let instance _ = kitáµ£ in
      (Ï• ,â‚– v) âˆ˜ wkáµ£ â‰¡ Ï•

  wk-cancels-,áµ£-âˆ˜ : âˆ€ (Ï• : Âµâ‚ â†’áµ£ Âµâ‚‚) (v : Âµâ‚‚ âˆ‹     m) â†’ (Ï• ,áµ£ v) áµ£âˆ˜áµ£ wkáµ£ â‰¡ Ï•
  wk-cancels-,â‚›-âˆ˜ : âˆ€ (Ï• : Âµâ‚ â†’â‚› Âµâ‚‚) (v : Âµâ‚‚ âŠ¢ mâ†’M m) â†’ (Ï• ,â‚› v) â‚›âˆ˜áµ£ wkáµ£ â‰¡ Ï•

  â‹¯-id : âˆ€ â¦ƒ ğ•‚ : Kit â¦„ {Âµ M} (v : Âµ âŠ¢ M) â†’ v â‹¯ idâ‚– {{ğ•‚}} â‰¡ v

  â‹¯-idâ‚› : âˆ€ {Âµ M} (v : Âµ âŠ¢ M) â†’ v â‹¯ idâ‚– {{kitâ‚›}} â‰¡ v
  â‹¯-idâ‚› = â‹¯-id

  â‹¯-idáµ£ : âˆ€ {Âµ M} (v : Âµ âŠ¢ M) â†’ v â‹¯ idâ‚– {{kitáµ£}} â‰¡ v
  â‹¯-idáµ£ = â‹¯-id


  module KIT = Kit {{...}}
  module CKIT = ComposeKit {{...}}
  module WKKIT = WkDistKit {{...}}

  terms            = I.terms
  kit-traversal    = I.kit-traversal
  kit-assoc        = I.kit-assoc
  kit-assoc-lemmas = I.kit-assoc-lemmas
  kitáµ£áµ£            = I.kitáµ£áµ£
  kitáµ£â‚›            = I.kitáµ£â‚›
  kitâ‚›áµ£            = I.kitâ‚›áµ£
  kitâ‚›â‚›            = I.kitâ‚›â‚›
  wk-kitáµ£          = I.wk-kitáµ£
  wk-kitâ‚›          = I.wk-kitâ‚›

  -- _âˆ‹/âŠ¢_ = KIT._âˆ‹/âŠ¢_

  wk  = KIT.wk
  wkáµ£ = I.wkáµ£
  wkâ‚› = I.wkâ‚›

  wk*  = KIT.wk*
  wkáµ£* = Kit.wk* kitáµ£
  wkâ‚›* = Kit.wk* kitâ‚›

  id = KIT.idâ‚–
  idáµ£ = I.idáµ£
  idâ‚› = I.idâ‚›

  _â†‘_ = KIT._â†‘_
  _â†‘áµ£_ = I._â†‘áµ£_
  _â†‘â‚›_ = I._â†‘â‚›_

  _â†‘*_  = KIT._â†‘*_
  _â†‘áµ£*_ = Kit._â†‘*_ kitáµ£
  _â†‘â‚›*_ = Kit._â†‘*_ kitâ‚›

  idâ†‘â‰¡id  = KIT.idâ†‘â‰¡id
  idâ†‘â‰¡idáµ£ = Kit.idâ†‘â‰¡id kitáµ£
  idâ†‘â‰¡idâ‚› = Kit.idâ†‘â‰¡id kitâ‚›

  idâ†‘*â‰¡id = KIT.idâ†‘*â‰¡id
  idâ†‘*â‰¡idáµ£ = Kit.idâ†‘*â‰¡id kitáµ£
  idâ†‘*â‰¡idâ‚› = Kit.idâ†‘*â‰¡id kitâ‚›

  _,â‚–_ = KIT._,â‚–_
  _,áµ£_ = I._,áµ£_
  _,â‚›_ = I._,â‚›_

  â¦…_â¦†  = KIT.â¦…_â¦†
  â¦…_â¦†áµ£ = I.â¦…_â¦†áµ£
  â¦…_â¦†â‚› = I.â¦…_â¦†â‚›

  â¦…_â¦†â‚€  = KIT.â¦…_â¦†â‚€
  â¦…_â¦†â‚€áµ£ = Kit.â¦…_â¦†â‚€ kitáµ£
  â¦…_â¦†â‚€â‚› = Kit.â¦…_â¦†â‚€ kitâ‚›

  0â‚– = KIT.emptyâ‚–
  0áµ£ = Kit.emptyâ‚– kitáµ£
  0â‚› = Kit.emptyâ‚– kitâ‚›

  wk'   = KIT.wk'
  wkáµ£'  = Kit.wk' kitáµ£
  wkâ‚›'  = Kit.wk' kitâ‚›

  wk'*  = KIT.wk'*
  wkáµ£'* = Kit.wk'* kitáµ£
  wkâ‚›'* = Kit.wk'* kitâ‚›

  _â‹¯_     = I._â‹¯_
  _â‹¯â‚›_    = I._â‹¯â‚›_
  _â‹¯áµ£_    = I._â‹¯áµ£_

  _âˆ˜_     = CKIT._âˆ˜â‚–_
  _âˆ˜áµ£_    = I._âˆ˜áµ£_
  _âˆ˜â‚›_    = I._âˆ˜â‚›_
  _áµ£âˆ˜áµ£_   = I._áµ£âˆ˜áµ£_
  _â‚›âˆ˜áµ£_   = I._â‚›âˆ˜áµ£_
  _áµ£âˆ˜â‚›_   = I._áµ£âˆ˜â‚›_
  _â‚›âˆ˜â‚›_   = I._â‚›âˆ˜â‚›_

  dist-â†‘-âˆ˜ = CKIT.dist-â†‘-âˆ˜
  dist-â†‘-áµ£âˆ˜áµ£ = ComposeKit.dist-â†‘-âˆ˜ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„ kitáµ£áµ£
  dist-â†‘-áµ£âˆ˜â‚› = ComposeKit.dist-â†‘-âˆ˜ â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ kitáµ£â‚›
  dist-â†‘-â‚›âˆ˜áµ£ = ComposeKit.dist-â†‘-âˆ˜ â¦ƒ kitâ‚› â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„ kitâ‚›áµ£
  dist-â†‘-â‚›âˆ˜â‚› = ComposeKit.dist-â†‘-âˆ˜ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ kitâ‚›â‚›

  dist-â†‘*-âˆ˜ = CKIT.dist-â†‘*-âˆ˜
  dist-â†‘*-áµ£âˆ˜áµ£ = ComposeKit.dist-â†‘*-âˆ˜ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£ â¦„ kitáµ£áµ£
  dist-â†‘*-áµ£âˆ˜â‚› = ComposeKit.dist-â†‘*-âˆ˜ â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ kitáµ£â‚›
  dist-â†‘*-â‚›âˆ˜áµ£ = ComposeKit.dist-â†‘*-âˆ˜ â¦ƒ kitâ‚› â¦„ â¦ƒ kitáµ£ â¦„ â¦ƒ kitâ‚› â¦„ kitâ‚›áµ£
  dist-â†‘*-â‚›âˆ˜â‚› = ComposeKit.dist-â†‘*-âˆ˜ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚› â¦„ kitâ‚›â‚›

  â‹¯-assoc = I.â‹¯-assoc

  _âˆ¥_     = KIT._âˆ¥_
  _âˆ¥áµ£_    = I._âˆ¥áµ£_
  _âˆ¥â‚›_    = I._âˆ¥â‚›_

  â‹¯-var   = I.â‹¯-var

  comm-â†‘-wk = WKKIT.comm-â†‘-wk
  comm-â†‘áµ£-wk = WkDistKit.comm-â†‘-wk â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„ wk-kitáµ£
  comm-â†‘â‚›-wk = WkDistKit.comm-â†‘-wk â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚›áµ£ â¦„ â¦ƒ kitáµ£â‚› â¦„ wk-kitâ‚›

  wk-cancels-,â‚–-âˆ˜ = WKKIT.wk-cancels-,â‚–-âˆ˜
  wk-cancels-,áµ£-âˆ˜ = WkDistKit.wk-cancels-,â‚–-âˆ˜ â¦ƒ kitáµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„ â¦ƒ kitáµ£áµ£ â¦„ wk-kitáµ£
  wk-cancels-,â‚›-âˆ˜ = WkDistKit.wk-cancels-,â‚–-âˆ˜ â¦ƒ kitâ‚› â¦„ â¦ƒ kitâ‚›áµ£ â¦„ â¦ƒ kitáµ£â‚› â¦„ wk-kitâ‚›

