open import Kitty.Term.Modes
open import Kitty.Term.Traversal using (Traversal; KitHomotopy)
import Kitty.Term.Sub

module Kitty.Term.ComposeKit {ğ•„ : Modes} (ğ•‹ : Terms ğ•„) (T : Traversal ğ•‹) (H : KitHomotopy ğ•‹ T) (ğ•Š : Kitty.Term.Sub.SubWithLaws ğ•‹) where

open import Data.List using (List; []; _âˆ·_)
open import Data.List.Membership.Propositional using (_âˆˆ_)
open import Data.List.Relation.Unary.Any using (here; there)
open import Level using (Level; _âŠ”_) renaming (suc to lsuc; zero to lzero)
open import Relation.Binary.PropositionalEquality using (_â‰¡_; refl; sym; trans; cong; congâ‚‚; subst; module â‰¡-Reasoning)
open import Relation.Nullary using (Â¬_)
open â‰¡-Reasoning

open import Kitty.Term.Prelude
open import Kitty.Term.Kit ğ•‹
open import Kitty.Term.KitOrder ğ•‹
open import Kitty.Term.Sub ğ•‹
open import Kitty.Util.SubstProperties

open Modes ğ•„
open Terms ğ•‹
open Traversal T
open KitHomotopy H
open Kit â¦ƒ â€¦ â¦„
open Sub â¦ƒ â€¦ â¦„
open SubWithLaws â¦ƒ â€¦ â¦„
open ~-Reasoning
open _âŠ‘â‚–_ â¦ƒ â€¦ â¦„

private instance _ = ğ•Š

private
  variable
    m mâ‚ mâ‚‚ mâ‚ƒ m' mâ‚' mâ‚‚' mâ‚ƒ' : VarMode
    M Mâ‚ Mâ‚‚ Mâ‚ƒ M' Mâ‚' Mâ‚‚' Mâ‚ƒ' : TermMode
    Âµ Âµâ‚ Âµâ‚‚ Âµâ‚ƒ Âµ' Âµâ‚' Âµâ‚‚' Âµâ‚ƒ' : List VarMode

private instance
  _ = kitáµ£
  _ = kitâ‚›

record ComposeKit (ğ•‚â‚ ğ•‚â‚‚ ğ•‚â‚âŠ”ğ•‚â‚‚ : Kit ) : Setâ‚ where
  infixl  8  _ap/â‹¯_

  private instance _ = ğ•‚â‚; _ = ğ•‚â‚‚; _ = ğ•‚â‚âŠ”ğ•‚â‚‚

  field
    â¦ƒ ğ•‚â‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ : ğ•‚â‚ âŠ‘â‚– ğ•‚â‚âŠ”ğ•‚â‚‚
    â¦ƒ ğ•‚â‚‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ : ğ•‚â‚‚ âŠ‘â‚– ğ•‚â‚âŠ”ğ•‚â‚‚

    _ap/â‹¯_ : âˆ€ {Âµâ‚} {Âµâ‚‚} {m/M}
             â†’ Âµâ‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] m/M
             â†’ Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚
             â†’ Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚âŠ”ğ•‚â‚‚ ] (Î¹-Mode m/M)

    ap/â‹¯-â‹¯ : âˆ€ {Âµâ‚} {Âµâ‚‚} {m/M} (x/t : Âµâ‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] m/M) (Ï• : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚) 
            â†’ let sub = subst (Âµâ‚‚ âŠ¢_) (Î¹-mâ†’M/id m/M) in
              `/id' â¦ƒ ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ _ (x/t ap/â‹¯ Ï•) â‰¡ sub (`/id' â¦ƒ ğ•‚â‚ â¦„ _ x/t â‹¯ Ï•)

    ap/â‹¯-ap : âˆ€ {Âµâ‚} {Âµâ‚‚} {m} (x : Âµâ‚ âˆ‹ m) (Ï• : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚) 
              â†’ let subâ‚ = subst (Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚âŠ”ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M â¦ƒ ğ•‚â‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ m) in
                let subâ‚‚ = subst (Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚âŠ”ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M â¦ƒ ğ•‚â‚‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ m) in
                subâ‚ (id/` _ x ap/â‹¯ Ï•) â‰¡ subâ‚‚ (Î¹-âˆ‹/âŠ¢ â¦ƒ ğ•‚â‚‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ (apâ‚– Ï• _ x))

    ~-cong-ap/â‹¯ :
      âˆ€ {x/tâ‚ x/tâ‚‚ : Âµâ‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] (id/mâ†’M m)}
        {Ï•â‚ Ï•â‚‚ : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚}
      â†’ x/tâ‚ â‰¡ x/tâ‚‚
      â†’ Ï•â‚ ~ Ï•â‚‚
      â†’ x/tâ‚ ap/â‹¯ Ï•â‚ â‰¡ x/tâ‚‚ ap/â‹¯ Ï•â‚‚

    -- ap/â‹¯-ap' : âˆ€ {Âµâ‚} {Âµâ‚‚} {m} (x : Âµâ‚ âˆ‹ m) (Ï• : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚) 
    --            â†’ id/` â¦ƒ ğ•‚â‚ â¦„ _ x ap/â‹¯ Ï• ~â‚œ[ sym {!Î¹-mâ†’M/id m!} ] apâ‚– Ï• _ x

    -- ap/â‹¯-wk : âˆ€ {Âµâ‚} {Âµâ‚‚} {m} {mx}
    --             (Ï• : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    --             (x : Âµâ‚ âˆ‹ mx)
    --           â†’ (apâ‚– Ï• _ x ap/â‹¯ wkâ‚– m id) â‰¡ Î¹-âˆ‹/âŠ¢ (wk _ (apâ‚– Ï• _ x))

-- -- --       let sub  = subst (Âµâ‚‚ âŠ¢_) (_âŠ‘â‚–_.Î¹-mâ†’M/id ğ•‚â‚‚âŠ‘ğ•‚ m/M) in
-- -- --       sub (Kit.`/id' ğ•‚â‚‚ _ x/t â‹¯ Ï•) â‰¡ Kit.`/id' ğ•‚ _ (x/t â‹¯á¶œ Ï•)

    -- tm-ap/â‹¯-Â· : âˆ€ (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    --               (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
    --               (x/t : Âµâ‚ âˆ‹/âŠ¢ m)
    --             â†’ `/id' _ (apâ‚– Ï•â‚ _ x) â‹¯ Ï•â‚‚ â‰¡ `/id _ (apâ‚– (Ï•â‚ Â·â‚– Ï•â‚‚) _ x)

    -- ap/â‹¯-ap : âˆ€ {m/M} (x/t : Âµâ‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] m/M) (Ï• : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚) 
    --           â†’ let sub = subst (Âµâ‚‚ âŠ¢_) (Î¹-mâ†’M/id m/M) in
    --             `/id' â¦ƒ ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ _ (x/t ap/â‹¯ Ï•) â‰¡ sub (`/id' â¦ƒ ğ•‚â‚ â¦„ _ x/t â‹¯ Ï•)

    -- dist-wk-Â· : âˆ€ m
    --               (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    --               (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
    --             â†’ wkâ‚– m (Ï•â‚ Â·â‚– Ï•â‚‚) ~ (Ï•â‚ Â·â‚– wkâ‚– m Ï•â‚‚)

    -- dist-,â‚–-Â·Ë¡ : âˆ€ {m}
    --                (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    --                (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
    --                (x/t : Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] id/mâ†’M m)
    --              â†’ let sub = subst (Âµâ‚ƒ âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
    --                ((Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚– sub (x/t ap/â‹¯ Ï•â‚‚)) ~ ((Ï•â‚ ,â‚– x/t) Â·â‚– Ï•â‚‚)

    -- dist-,â‚–-Â·Ê³ : âˆ€ {m}
    --                (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    --                (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
    --                (x/t : Âµâ‚ƒ âˆ‹/âŠ¢[ ğ•‚â‚‚ ] id/mâ†’M m)
    --              â†’ ((Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚–' x/t) ~ ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ ,â‚– x/t))

    -- -- dist-,â‚–-Â·Ê³ : âˆ€ {m}
    -- --                (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
    -- --                (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
    -- --                (x/t : Âµâ‚ƒ âˆ‹/âŠ¢[ ğ•‚â‚‚ ] id/mâ†’M m)
    -- --              â†’ let sub = subst (Âµâ‚ƒ âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
    -- --                (((Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚– sub (Î¹-âˆ‹/âŠ¢ x/t))) ~ ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ ,â‚– x/t))

infixl  8  _ap/â‹¯[_]_

_ap/â‹¯[_]_ : âˆ€ â¦ƒ ğ•‚â‚ ğ•‚â‚‚ ğ•‚â‚âŠ”ğ•‚â‚‚ â¦„ {m/M}
            â†’ Âµâ‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] m/M
            â†’ (C : ComposeKit ğ•‚â‚ ğ•‚â‚‚ ğ•‚â‚âŠ”ğ•‚â‚‚)
            â†’ Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚
            â†’ Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚âŠ”ğ•‚â‚‚ ] (Î¹-Mode â¦ƒ ComposeKit.ğ•‚â‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚ C â¦„ m/M)
x/t ap/â‹¯[ C ] Ï• = x/t ap/â‹¯ Ï• where open ComposeKit C

  -- dist-â†‘-Â· : âˆ€ {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m
  --              (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
  --              (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
  --            â†’ ((Ï•â‚ Â·â‚– Ï•â‚‚) â†‘ m) ~ ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ â†‘ m))
  -- dist-â†‘-Â· {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m Ï•â‚ Ï•â‚‚ mx x@(here refl) =
  --   let sub = subst ((Âµâ‚ƒ â–· m) âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
  --   let sub' = subst ((Âµâ‚ƒ â–· m) âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in -- different âŠ‘-instance
  --   apâ‚– ((Ï•â‚ Â·â‚– Ï•â‚‚) â†‘ m) _ x                  â‰¡âŸ¨ apâ‚–-â†‘-here (Ï•â‚ Â·â‚– Ï•â‚‚) âŸ©
  --   id/` _ (here refl)                        â‰¡âŸ¨ {!Î¹-`/id!} âŸ©
  --   sub' (Î¹-âˆ‹/âŠ¢ (id/` _ (here refl)))         â‰¡âŸ¨ cong (Î» â–  â†’ sub' (Î¹-âˆ‹/âŠ¢ â– )) (sym (apâ‚–-â†‘-here Ï•â‚‚)) âŸ©
  --   sub' (Î¹-âˆ‹/âŠ¢ (apâ‚– (Ï•â‚‚ â†‘ m) _ (here refl))) â‰¡âŸ¨ sym (Î¹-ap-â†’ (Ï•â‚‚ â†‘ m) (here refl)) âŸ© -- requires ğ•‚â‚‚âŠ‘âŠ”
  --   apâ‚– (Î¹-â†’ (Ï•â‚‚ â†‘ m)) _(here refl)           â‰¡âŸ¨ {!!} âŸ©
  --   sub (id/` _ (here refl) ap/â‹¯ (Ï•â‚‚ â†‘ m))    â‰¡âŸ¨ {!!} âŸ©
  --   sub (apâ‚– (Ï•â‚ â†‘ m) _ x ap/â‹¯ (Ï•â‚‚ â†‘ m))      â‰¡âŸ¨ {!!} âŸ©
  --   apâ‚– ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ â†‘ m)) _ x            âˆ
  -- dist-â†‘-Â· {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m Ï•â‚ Ï•â‚‚ mx x@(there y) = {!!}

  -- dist-â†‘-Â· : âˆ€ {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m
  --              (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
  --              (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
  --            â†’ ((Ï•â‚ Â·â‚– Ï•â‚‚) â†‘ m) ~ ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ â†‘ m))
  -- dist-â†‘-Â· {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m Ï•â‚ Ï•â‚‚ =
  --   ((Ï•â‚ Â·â‚– Ï•â‚‚) â†‘ m)                                                       ~âŸ¨ â†‘-,â‚– (Ï•â‚ Â·â‚– Ï•â‚‚) m âŸ©
  --   (wkâ‚– m (Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚– id/` _ (here refl))                               ~âŸ¨ ~-cong-,â‚– (dist-wk-Â· m Ï•â‚ Ï•â‚‚) refl âŸ©
  --   ((Ï•â‚ Â·â‚– wkâ‚– m Ï•â‚‚) ,â‚– id/` _ (here refl))                               ~âŸ¨ {!!} âŸ©
  --   ((wkâ‚– m Ï•â‚ ,â‚– id/` _ (here refl)) Â·â‚– (wkâ‚– m Ï•â‚‚ ,â‚– id/` _ (here refl))) ~âŸ¨ ~-sym (~-cong-Â· (â†‘-,â‚– Ï•â‚ m) (â†‘-,â‚– Ï•â‚‚ m)) âŸ©
  --   ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ â†‘ m))                                                 ~âˆ
    
  -- dist-â†‘-Â· {Âµâ‚} {Âµâ‚‚} {Âµâ‚ƒ} m Ï•â‚ Ï•â‚‚ =
  --   let sub = subst ((Âµâ‚ƒ â–· m) âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
  --   ((Ï•â‚ Â·â‚– Ï•â‚‚) â†‘ m)                         ~âŸ¨ â†‘-,â‚– (Ï•â‚ Â·â‚– Ï•â‚‚) m âŸ©
  --   (wkâ‚– m (Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚– id/` _ (here refl)) ~âŸ¨ {!!} âŸ©
  --   ((Ï•â‚ Â·â‚– wkâ‚– m Ï•â‚‚) ,â‚– id/` _ (here refl)) ~âŸ¨ {!!} âŸ©
  --   ((Ï•â‚ Â·â‚– wkâ‚– m Ï•â‚‚) ,â‚– sub ({!id/` _ (here refl)!} ap/â‹¯ wkâ‚– m Ï•â‚‚)) ~âŸ¨ {!!} âŸ©
  --   ((wkâ‚– m Ï•â‚ ,â‚– id/` _ (here refl)) Â·â‚– (wkâ‚– m Ï•â‚‚ ,â‚– id/` _ (here refl))) ~âŸ¨ ~-sym (~-cong-Â· (â†‘-,â‚– Ï•â‚ m) (â†‘-,â‚– Ï•â‚‚ m)) âŸ©
  --   ((Ï•â‚ â†‘ m) Â·â‚– (Ï•â‚‚ â†‘ m)) ~âˆ

  -- dist-,â‚–-Â· : âˆ€ {m}
  --               (Ï•â‚ : Âµâ‚ â€“[ ğ•‚â‚ ]â†’ Âµâ‚‚)
  --               (Ï•â‚‚ : Âµâ‚‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚ƒ)
  --               (x/t : Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] id/mâ†’M m)
  --             â†’ let sub = subst (Âµâ‚ƒ âˆ‹/âŠ¢[ ğ•‚â‚âŠ” ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
  --               ((Ï•â‚ Â·â‚– Ï•â‚‚) ,â‚– sub (x/t ap/â‹¯ Ï•â‚‚)) ~ (Ï•â‚ ,â‚– x/t Â·â‚– Ï•â‚‚)

-- ComposeKit for Renamings ----------------------------------------------------

ap/â‹¯-wkáµ£ : âˆ€ â¦ƒ ğ•‚ : Kit â¦„ {Âµâ‚} {Âµâ‚‚} {m} {mx}
             (Ï• : Âµâ‚ â€“[ kitáµ£ ]â†’ Âµâ‚‚)
             (x : Âµâ‚ âˆ‹ mx)
           â†’ (apâ‚– (wkâ‚– â¦ƒ ğ•‚ = ğ•‚ â¦„ m id) _ (apâ‚– Ï• _ x)) â‰¡ Î¹-âˆ‹/âŠ¢ â¦ƒ âŠ‘â‚–-âŠ¥ â¦ƒ ğ•‚ = ğ•‚ â¦„ â¦„ (wk _ (apâ‚– Ï• _ x))
ap/â‹¯-wkáµ£ â¦ƒ ğ•‚ â¦„ {Âµâ‚} {Âµâ‚‚} {m} {mx} Ï• x =
  apâ‚– (wkâ‚– _ id) _ (apâ‚– Ï• _ x)            â‰¡âŸ¨ apâ‚–-wkâ‚–-wk id (apâ‚– Ï• _ x) âŸ©
  wk _ (apâ‚– id _ (apâ‚– Ï• _ x))             â‰¡âŸ¨ cong (wk _) (apâ‚–-id (apâ‚– Ï• _ x)) âŸ©
  wk _ (id/` _ (apâ‚– Ï• _ x))               â‰¡âŸ¨ sym (Î¹-wk â¦ƒ âŠ‘â‚–-âŠ¥ â¦ƒ ğ•‚ = ğ•‚ â¦„ â¦„ {m = m} (apâ‚– Ï• _ x)) âŸ©
  Î¹-âˆ‹/âŠ¢ â¦ƒ âŠ‘â‚–-âŠ¥ â¦ƒ ğ•‚ = ğ•‚ â¦„ â¦„ (wk _ (apâ‚– Ï• _ x)) âˆ

ap/â‹¯-â‹¯áµ£ : âˆ€ â¦ƒ ğ•‚â‚‚ â¦„ {Âµâ‚} {Âµâ‚‚} {m} (x : Âµâ‚ âˆ‹ m) (Ï• : Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚) 
        â†’ let sub = subst (Âµâ‚‚ âŠ¢_) (sym (id/mâ†’M/id m)) in
          `/id' â¦ƒ ğ•‚â‚‚ â¦„ _ (apâ‚– Ï• _ x) â‰¡ sub (` x â‹¯ Ï•)
ap/â‹¯-â‹¯áµ£ â¦ƒ ğ•‚â‚‚ â¦„ {Âµâ‚} {Âµâ‚‚} {m} x Ï• =
  let sub = subst (Âµâ‚‚ âŠ¢_) (id/mâ†’M/id m) in
  let subâ»Â¹ = subst (Âµâ‚‚ âŠ¢_) (sym (id/mâ†’M/id m)) in
  `/id' â¦ƒ ğ•‚â‚‚ â¦„ _ (apâ‚– Ï• _ x)         â‰¡âŸ¨ sym (cancel-subst (Âµâ‚‚ âŠ¢_) (id/mâ†’M/id m) (`/id' _ (apâ‚– Ï• _ x))) âŸ©
  subâ»Â¹ (sub (`/id' _ (apâ‚– Ï• _ x)))  â‰¡âŸ¨ cong subâ»Â¹ (sym (`/idâ‰¡`/id' (apâ‚– Ï• _ x))) âŸ©
  subâ»Â¹ (`/id â¦ƒ ğ•‚â‚‚ â¦„ _ (apâ‚– Ï• _ x))  â‰¡âŸ¨ cong subâ»Â¹ (sym (â‹¯-var x Ï•)) âŸ©
  subâ»Â¹ (` x â‹¯ Ï•)                    âˆ

ckitáµ£ : âˆ€ â¦ƒ ğ•‚ â¦„ â†’ ComposeKit kitáµ£ ğ•‚ ğ•‚
ckitáµ£ â¦ƒ ğ•‚ â¦„ = record
  { ğ•‚â‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚   = âŠ‘â‚–-âŠ¥ â¦ƒ ğ•‚ = ğ•‚ â¦„
  ; ğ•‚â‚‚âŠ‘ğ•‚â‚âŠ”ğ•‚â‚‚   = âŠ‘â‚–-refl â¦ƒ ğ•‚ â¦„
  ; _ap/â‹¯_      = Î» x Ï• â†’ apâ‚– Ï• _ x
  ; ap/â‹¯-â‹¯      = ap/â‹¯-â‹¯áµ£
  ; ap/â‹¯-ap     = Î» x Ï• â†’ refl
  -- ; _Â·â‚–_        = _áµ£Â·_
  -- ; ap/â‹¯-Â·â‚–     = ap-áµ£Â·
  -- ; ap/â‹¯-wk     = ap/â‹¯-wkáµ£
  -- ; tm-â‹¯-Â·      = tm-â‹¯-áµ£Â·
  -- ; dist-â†‘-Â·    = dist-â†‘-áµ£Â·
  -- ; ~-cong-Â·    = ~-cong-áµ£Â·
  ; ~-cong-ap/â‹¯ = Î» { refl Ï•â‚~Ï•â‚‚ â†’ ~â†’~' Ï•â‚~Ï•â‚‚ _ _ }
  }
