open import Kitty.Term.Modes

module Kitty.Term.KitOrder {ğ•„ : Modes} (ğ•‹ : Terms ğ•„) where

open import Relation.Binary.PropositionalEquality using (_â‰¡_; refl; sym; cong; subst; module â‰¡-Reasoning)
open â‰¡-Reasoning

open import Kitty.Term.Prelude
open import Kitty.Term.Kit ğ•‹
open import Kitty.Util.SubstProperties

open Modes ğ•„
open Terms ğ•‹
open Kit â¦ƒ â€¦ â¦„

private variable
  KitMode KitModeâ‚ KitModeâ‚‚ : Set
  _âˆ‹/âŠ¢_ _âˆ‹/âŠ¢â‚_ _âˆ‹/âŠ¢â‚‚_ : List VarMode â†’ KitMode â†’ Set
  â¦ƒ ğ•‚ â¦„ â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚  â¦„ : Kit _âˆ‹/âŠ¢_

record _âŠ‘â‚–_ (ğ•‚â‚ : Kit _âˆ‹/âŠ¢â‚_) (ğ•‚â‚‚ : Kit _âˆ‹/âŠ¢â‚‚_) : Setâ‚ where 
  private instance _ = ğ•‚â‚; _ = ğ•‚â‚‚
  field
    Î¹-Mode : mode ğ•‚â‚ â†’ mode ğ•‚â‚‚
    Î¹-id/mâ†’M : âˆ€ m â†’ Î¹-Mode (Kit.id/mâ†’M ğ•‚â‚ m) â‰¡ Kit.id/mâ†’M ğ•‚â‚‚ m
    Î¹-mâ†’M/id : âˆ€ m/M â†’ Kit.mâ†’M/id ğ•‚â‚ m/M â‰¡ Kit.mâ†’M/id ğ•‚â‚‚ (Î¹-Mode m/M)

    Î¹-âˆ‹/âŠ¢  : âˆ€ {Âµ} {m} â†’ Âµ âˆ‹/âŠ¢[ ğ•‚â‚ ] id/mâ†’M m â†’ Âµ âˆ‹/âŠ¢[ ğ•‚â‚‚ ] id/mâ†’M m
    Î¹-id/` : âˆ€ {Âµ} {m} (x : Âµ âˆ‹ m)
             â†’ Î¹-âˆ‹/âŠ¢ (Kit.id/` ğ•‚â‚ x) â‰¡ Kit.id/` ğ•‚â‚‚ x
    Î¹-`/id : âˆ€ {Âµ} {m} (x/t : Âµ âˆ‹/âŠ¢[ ğ•‚â‚ ] Kit.id/mâ†’M ğ•‚â‚ m)
             â†’ Kit.`/id ğ•‚â‚ x/t â‰¡ Kit.`/id ğ•‚â‚‚ (Î¹-âˆ‹/âŠ¢ x/t)

    Î¹-wk : âˆ€ {m'} {m} {Âµ} (x/t : Âµ âˆ‹/âŠ¢[ ğ•‚â‚ ] id/mâ†’M m)
             â†’ Î¹-âˆ‹/âŠ¢ (Kit.wk ğ•‚â‚ m' x/t) â‰¡ Kit.wk ğ•‚â‚‚ m' (Î¹-âˆ‹/âŠ¢ x/t)

  -- _,â‚–'_ : âˆ€ {Âµâ‚} {Âµâ‚‚} {m}
  --         â†’ Âµâ‚ â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚
  --         â†’ Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚ ] id/mâ†’M m
  --         â†’ (Âµâ‚ â–· m) â€“[ ğ•‚â‚‚ ]â†’ Âµâ‚‚
  -- _,â‚–'_ {Âµâ‚} {Âµâ‚‚} {m} Ï• x/t =
  --   let sub = subst (Âµâ‚‚ âˆ‹/âŠ¢[ ğ•‚â‚‚ ]_) (Î¹-id/mâ†’M m) in
  --   Ï• ,â‚–  sub (Î¹-âˆ‹/âŠ¢ x/t)

âŠ‘â‚–-refl : ğ•‚ âŠ‘â‚– ğ•‚
âŠ‘â‚–-refl = record
  { Î¹-Mode   = Î» m/M â†’ m/M
  ; Î¹-id/mâ†’M = Î» m â†’ refl
  ; Î¹-mâ†’M/id = Î» m/M â†’ refl
  ; Î¹-âˆ‹/âŠ¢    = Î» x â†’ x
  ; Î¹-id/`   = Î» x â†’ refl
  ; Î¹-`/id   = Î» x/t â†’ refl
  ; Î¹-wk     = Î» x/t â†’ refl
  }

-- -- Probably not needed
-- âŠ‘â‚–-trans : âˆ€ â¦ƒ ğ•‚â‚ ğ•‚â‚‚ ğ•‚â‚ƒ : Kit â¦„ â†’ ğ•‚â‚ âŠ‘â‚– ğ•‚â‚‚ â†’ ğ•‚â‚‚ âŠ‘â‚– ğ•‚â‚ƒ â†’ ğ•‚â‚ âŠ‘â‚– ğ•‚â‚ƒ
-- _âŠ‘â‚–_.Î¹-Mode (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) m/M =
--   Î¹-Mode ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-Mode ğ•‚â‚âŠ‘ğ•‚â‚‚ m/M)
--   where open _âŠ‘â‚–_
-- _âŠ‘â‚–_.Î¹-id/mâ†’M (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) m =
--   Î¹-Mode ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-Mode ğ•‚â‚âŠ‘ğ•‚â‚‚ (Kit.id/mâ†’M ğ•‚â‚ m)) â‰¡âŸ¨ cong (Î¹-Mode ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) (Î¹-id/mâ†’M ğ•‚â‚âŠ‘ğ•‚â‚‚ m) âŸ©
--   Î¹-Mode ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Kit.id/mâ†’M ğ•‚â‚‚ m)                 â‰¡âŸ¨ Î¹-id/mâ†’M ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ m âŸ©
--   Kit.id/mâ†’M ğ•‚â‚ƒ m                                 âˆ
--   where open _âŠ‘â‚–_
-- _âŠ‘â‚–_.Î¹-mâ†’M/id (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) m/M =
--   Kit.mâ†’M/id ğ•‚â‚ m/M                                 â‰¡âŸ¨ Î¹-mâ†’M/id ğ•‚â‚âŠ‘ğ•‚â‚‚ m/M âŸ©
--   Kit.mâ†’M/id ğ•‚â‚‚ (Î¹-Mode ğ•‚â‚âŠ‘ğ•‚â‚‚ m/M)                 â‰¡âŸ¨ Î¹-mâ†’M/id ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-Mode ğ•‚â‚âŠ‘ğ•‚â‚‚ m/M) âŸ©
--   Kit.mâ†’M/id ğ•‚â‚ƒ (Î¹-Mode ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-Mode ğ•‚â‚âŠ‘ğ•‚â‚‚ m/M)) âˆ
--   where open _âŠ‘â‚–_
-- _âŠ‘â‚–_.Î¹-âˆ‹/âŠ¢ (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) x =
--   Î¹-âˆ‹/âŠ¢ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-âˆ‹/âŠ¢ ğ•‚â‚âŠ‘ğ•‚â‚‚ x)
--   where open _âŠ‘â‚–_
-- _âŠ‘â‚–_.Î¹-id/` (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) {Âµ} {m} x =
--   let sub = subst (Âµ âˆ‹/âŠ¢[ ğ•‚â‚ƒ ]_) (sym (Î¹-id/mâ†’M (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) m)) in
--   let subâ‚ = subst (Âµ âˆ‹/âŠ¢[ ğ•‚â‚‚ ]_) (sym (Î¹-id/mâ†’M ğ•‚â‚âŠ‘ğ•‚â‚‚ m)) in
--   let subâ‚‚ = subst (Âµ âˆ‹/âŠ¢[ ğ•‚â‚ƒ ]_) (sym (Î¹-id/mâ†’M ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ m)) in
--   let subâ‚‚' = subst (Âµ âˆ‹/âŠ¢[ ğ•‚â‚ƒ ]_) (Î¹-id/mâ†’M ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ m) in
--   Î¹-âˆ‹/âŠ¢ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Î¹-âˆ‹/âŠ¢ ğ•‚â‚âŠ‘ğ•‚â‚‚ (Kit.id/` ğ•‚â‚ m x)) â‰¡âŸ¨ cong (Î¹-âˆ‹/âŠ¢ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) (Î¹-id/` ğ•‚â‚âŠ‘ğ•‚â‚‚ x) âŸ©
--   Î¹-âˆ‹/âŠ¢ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (subâ‚ (Kit.id/` ğ•‚â‚‚ m x))         â‰¡âŸ¨ {!!} âŸ©
--   sub (subâ‚‚' (Î¹-âˆ‹/âŠ¢ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ (Kit.id/` ğ•‚â‚‚ m x)))  â‰¡âŸ¨ cong sub (cong subâ‚‚' (Î¹-id/` ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ x)) âŸ©
--   sub (subâ‚‚' (subâ‚‚ (Kit.id/` ğ•‚â‚ƒ m x)))          â‰¡âŸ¨ {!!} âŸ©
--   sub (Kit.id/` ğ•‚â‚ƒ m x)                         âˆ
--   where open _âŠ‘â‚–_
-- _âŠ‘â‚–_.Î¹-`/id (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) = {!!}
-- _âŠ‘â‚–_.Î¹-`/id' (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) = {!!}
-- _âŠ‘â‚–_.Î¹-wk (âŠ‘â‚–-trans â¦ƒ ğ•‚â‚ â¦„ â¦ƒ ğ•‚â‚‚ â¦„ â¦ƒ ğ•‚â‚ƒ â¦„ ğ•‚â‚âŠ‘ğ•‚â‚‚ ğ•‚â‚‚âŠ‘ğ•‚â‚ƒ) = {!!}
