module Kitty.Examples.SystemFSub-Derive.LogicalSubtyping where

open import Data.Product using (_,_)
open import Kitty.Term.Prelude using (_âˆ‹_; List; []; _â–·_) public
open import Kitty.Term.Terms using (Terms; SortTy; Var; NoVar)

open import Kitty.Examples.SystemFSub-Derive.Definitions

infix   3  _âŠ¢_âŠ‘_

data _âŠ¢_âŠ‘_ : Ctx S â†’ S âŠ¢ s â†’ S âŠ¢ s â†’ Set where
  âŠ‘-` : {Î“ : Ctx S} {c : S âŠ¢ ğ•”} â†’
    Î“ âŠ¢ c âˆ¶ (tâ‚ âˆ¶âŠ‘ tâ‚‚) â†’
    Î“ âŠ¢ tâ‚ âŠ‘ tâ‚‚
  âŠ‘-ğŸ™ :
    Î“ âŠ¢ t âŠ‘ ğŸ™
  âŠ‘-â‡’ :
    Î“ âŠ¢ tâ‚' âŠ‘ tâ‚ â†’
    Î“ âŠ¢ tâ‚‚  âŠ‘ tâ‚‚' â†’
    Î“ âŠ¢ (tâ‚ â‡’ tâ‚‚) âŠ‘ (tâ‚' â‡’ tâ‚‚')
  âŠ‘-âˆ€ : {Î“ : Ctx S} â†’
    Î“ â–¶ â˜… âŠ¢ tâ‚‚ âŠ‘ tâ‚‚' â†’
    Î“ âŠ¢ (âˆ€[Î±âŠ‘ tâ‚ ] tâ‚‚) âŠ‘ (âˆ€[Î±âŠ‘ tâ‚ ] tâ‚‚')
  âŠ‘-refl : 
    Î“ âŠ¢ t âŠ‘ t
  âŠ‘-trans : 
    Î“ âŠ¢ tâ‚ âŠ‘ tâ‚‚ â†’
    Î“ âŠ¢ tâ‚‚ âŠ‘ tâ‚ƒ â†’
    Î“ âŠ¢ tâ‚ âŠ‘ tâ‚ƒ

âŠ‘â†’âŠ‘â‚ :
  Î“ âŠ¢ tâ‚ âŠ‘ tâ‚‚ â†’ 
  Î“ âŠ¢ tâ‚ âŠ‘â‚ tâ‚‚
âŠ‘â†’âŠ‘â‚ (âŠ‘-` y)               = âŠ‘â‚-` âŠ‘â‚-refl y âŠ‘â‚-refl
âŠ‘â†’âŠ‘â‚ âŠ‘-ğŸ™                   = âŠ‘â‚-ğŸ™
âŠ‘â†’âŠ‘â‚ (âŠ‘-â‡’ tâ‚âŠ‘tâ‚‚ tâ‚âŠ‘tâ‚ƒ)     = âŠ‘â‚-â‡’ (âŠ‘â†’âŠ‘â‚ tâ‚âŠ‘tâ‚‚) (âŠ‘â†’âŠ‘â‚ tâ‚âŠ‘tâ‚ƒ)
âŠ‘â†’âŠ‘â‚ (âŠ‘-âˆ€ tâ‚âŠ‘tâ‚‚)           = âŠ‘â‚-âˆ€ (âŠ‘â†’âŠ‘â‚ tâ‚âŠ‘tâ‚‚)
âŠ‘â†’âŠ‘â‚ âŠ‘-refl                = âŠ‘â‚-refl
âŠ‘â†’âŠ‘â‚ (âŠ‘-trans tâ‚âŠ‘tâ‚‚ tâ‚âŠ‘tâ‚ƒ) = âŠ‘â‚-trans (âŠ‘â†’âŠ‘â‚ tâ‚âŠ‘tâ‚‚) (âŠ‘â†’âŠ‘â‚ tâ‚âŠ‘tâ‚ƒ)

âŠ‘â‚â†’âŠ‘ :
  Î“ âŠ¢ tâ‚ âŠ‘â‚ tâ‚‚ â†’ 
  Î“ âŠ¢ tâ‚ âŠ‘ tâ‚‚
âŠ‘â‚â†’âŠ‘ (âŠ‘â‚-` tâ‚âŠ‘â‚tâ‚‚ y tâ‚‚âŠ‘â‚tâ‚ƒ)         = âŠ‘-trans (âŠ‘â‚â†’âŠ‘ tâ‚âŠ‘â‚tâ‚‚) (âŠ‘-trans (âŠ‘-` y) (âŠ‘â‚â†’âŠ‘ tâ‚‚âŠ‘â‚tâ‚ƒ))
âŠ‘â‚â†’âŠ‘ âŠ‘â‚-ğŸ™                           = âŠ‘-ğŸ™
âŠ‘â‚â†’âŠ‘ (âŠ‘â‚-â‡’ tâ‚âŠ‘â‚tâ‚‚ tâ‚âŠ‘â‚tâ‚ƒ)           = âŠ‘-â‡’ (âŠ‘â‚â†’âŠ‘ tâ‚âŠ‘â‚tâ‚‚) (âŠ‘â‚â†’âŠ‘ tâ‚âŠ‘â‚tâ‚ƒ)
âŠ‘â‚â†’âŠ‘ (âŠ‘â‚-âˆ€ tâ‚âŠ‘â‚tâ‚‚)                  = âŠ‘-âˆ€ (âŠ‘â‚â†’âŠ‘ tâ‚âŠ‘â‚tâ‚‚)
âŠ‘â‚â†’âŠ‘ âŠ‘â‚-refl-var                    = âŠ‘-refl

